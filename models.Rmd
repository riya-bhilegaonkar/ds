---
title: "Tested Classification Models"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r}
#Load Libraries
library(chunked)
library(tidyverse)
library(caret)
library(FNN)
library(doBy)
library(data.table)
library(h2o)

#for reproducibility
set.seed(4)
```

```{r}
#Data Preparation
diabetes_risk <- fread("data/diabetes_risk_data.csv") %>% rename(member_id = 1) %>% mutate(gender = recode(
    gender,
    "Male" = 0,
    "Female" = 1)) %>% mutate(diabetes = as.factor(diabetes))

#Data Partition
indexTrain <- createDataPartition(y = diabetes_risk$diabetes, p = 0.8, list = FALSE)
trainData <- diabetes_risk[indexTrain, ]
testData <- diabetes_risk[-indexTrain, ]

#for model training
trainData <- na.omit(trainData)
testData <- na.omit(testData)

trainData <- trainData[,-1]
testData <- testData[-1]

```

```{r}
#for h2o package
localH2O <- h2o.init(nthreads = -1)

#data as h2o cluster
train.h2o <- as.h2o(trainData)
test.h2o <- as.h2o(testData)

#dependent variable (Purchase)
y.dep <- 12

#independent variables (dropping ID variables)
x.indep <- c(1:11,13)
```

```{r}
#Model Training with Random Forest
rforest.model <- h2o.randomForest(y=y.dep, x=x.indep, training_frame = train.h2o, ntrees = 1000, mtries = 3, max_depth = 4, seed = 4)

#Performance Metrics
h2o.performance(rforest.model, newdata = test.h2o)
```

```{r}
#Model Training with Logistic Regression
logit.model <- h2o.glm( x = x.indep,
                                y = y.dep, 
                               training_frame = train.h2o, 
                               seed = 4,
                               family = "binomial",
                               lambda_search = TRUE,
                               alpha = 0.5, 
                               nfolds = 5 )

#Performance Metrics
h2o.performance(logit.model, newdata = test.h2o)
```

```{r}
#Model Training with Naive Bayes
naive.h2o <- h2o.naiveBayes(x = x.indep,
                          y = y.dep,
                          training_frame = train.h2o,
                          laplace = 0,
                          nfolds = 5,
                          seed = 4)

#Performance Metrics
h2o.performance(naive.h2o, newdata = test.h2o)
```


```{r}
#Model Training with SVM
#svm_model <- h2o.psvm(gamma = 0.01,
#                      rank_ratio = 0.1,
    #                  y = y.dep,
   #                   training_frame = train.h2o,
   #                   disable_training_metrics = FALSE)

# Eval performance:
#h2o.performance(svm_model, newdata = test.h2o)
```